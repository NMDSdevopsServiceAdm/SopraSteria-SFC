<div>
  <div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">
      <div class="parentRequestTextContainer">
        <span class="govuk-caption-l">{{ workplace.name }}</span>
        <h1 class="govuk-heading-l">Link to a parent workplace</h1>
      </div>
    </div>
  </div>
  <div class="govuk-grid-row">
    <div class="govuk-grid-column-two-thirds">
      <div class="parentRequestTextContainer">
        <p>
          When you send a link request to a parent workplace, the parent needs to approve your request. You’ll get a
          notification to tell you whether your request was approved or not.
        </p>

        <h2>What's a parent workplace?</h2>

        <p>
          A parent workplace is a workplace that's taken responsibility in ASC-WDS for a number of other workplaces as
          part of a group or organisation.
        </p>
        <app-details data-testid="linkToParentRevealTitle" [title]="'Why you might link to a parent workplace'"
          ><p data-testid="linkToParentRevealText">
            You can allow a parent workplace to view or edit your data. Alternatively, you can just link to a parent to
            show that you’re part of a group or organisation.
          </p></app-details
        >
      </div>
      <app-error-summary
        *ngIf="submitted && (form.invalid || serverError)"
        [formErrorsMap]="formErrorsMap"
        [form]="form"
        [serverError]="serverError"
      >
      </app-error-summary>

      <form #formEl novalidate (ngSubmit)="onSubmit()" [formGroup]="form" autocomplete="off" aria-label="form">
        <div class="govuk-form-group" [class.govuk-form-group--error]="submitted && form.invalid">
          <fieldset class="govuk-fieldset">
            <legend class="govuk-fieldset__legend govuk-fieldset__legend--m">
              <h3 class="govuk-fieldset__heading">Select the parent workplace</h3>
            </legend>
            <div class="govuk-form-group">
              <label class="govuk-label" for="parentNameOrPostCode"
                >Start to type the parent workplace's name or postcode</label
              >
              <span
                *ngIf="submitted && form.get('parentNameOrPostCode').invalid"
                id="parentNameOrPostCode-error"
                class="govuk-error-message"
              >
                <span class="govuk-visually-hidden">Error:</span>
                {{ getFirstErrorMessage('parentNameOrPostCode') }}
              </span>

              <app-auto-suggest
                [formGroup]="form"
                [dataProvider]="parentNameOrPostCodeFilter"
                [formControlName]="'parentNameOrPostCode'"
              ></app-auto-suggest>
            </div>
            <h3>Data permissions</h3>
            <p class="govuk">
              If the parent workplace approves your request, what data do you want them to have
              <span class="govuk-!-font-weight-bold">view only access</span> to?
            </p>
            <span
              *ngIf="submitted && form.get('dataPermission').invalid"
              id="dataPermission-error"
              class="govuk-error-message"
            >
              <span class="govuk-visually-hidden">Error:</span> {{ getFirstErrorMessage('dataPermission') }}
            </span>

            <!-- <div class="govuk-radios" data-module="govuk-radios">
              <div class="govuk-radios__item">
                <input
                  class="govuk-radios__input"
                  id="dataPermission-0"
                  name="dataPermission"
                  type="radio"
                  value="dataPermissions[0]"
                />
                <label class="govuk-label govuk-radios__label" for="dataPermission-0">
                  {{ dataPermissions[0] | dataViewPermissions }}
                </label>
              </div>
              <div class="govuk-radios__item">
                <input
                  class="govuk-radios__input"
                  id="dataPermission-1"
                  name="dataPermission"
                  type="radio"
                  value="dataPermissions[1]"
                />
                <label class="govuk-label govuk-radios__label" for="dataPermission-1">
                  {{ dataPermissions[1] | dataViewPermissions }}
                </label>
              </div>
              <div class="govuk-radios__divider">or</div>
              <div class="govuk-radios__item">
                <input
                  class="govuk-radios__input"
                  id="dataPermissions-2"
                  name="dataPermission"
                  type="radio"
                  value="dataPermission[2]"
                />
                <label class="govuk-label govuk-radios__label" for="dataPermissions-2">
                  {{ dataPermissions[2] | dataViewPermissions }}
                </label>
              </div>
            </div> -->
            <div class="govuk-radios" data-module="govuk-radios">
              <div class="govuk-radios__item" *ngFor="let dataPermission of dataPermissions; let i = index">
                <input
                  class="govuk-radios__input"
                  id="dataPermission-{{ i }}"
                  name="dataPermission"
                  [formControlName]="'dataPermission'"
                  type="radio"
                  [value]="dataPermission"
                />

                <label class="govuk-label govuk-radios__label" for="dataPermission-{{ i }}">
                  {{ dataPermission | newDataViewPermissions }}
                </label>

                <div>
                  <p *ngIf="i === dataPermissions.length - 2" class="govuk-radios__divider">or</p>
                </div>
              </div>
            </div>
          </fieldset>
        </div>
        <div class="linkToParentRequestButtonContainer">
          <button type="submit" (click)="sendRequestToParent()" class="govuk-button">Send link request</button>
          <a
            href="#"
            [routerLink]="['/dashboard']"
            class="govuk-list govuk-list--inline govuk-util__float-right govuk-!-margin-top-3"
            >Cancel</a
          >
        </div>
      </form>
    </div>
  </div>
</div>
