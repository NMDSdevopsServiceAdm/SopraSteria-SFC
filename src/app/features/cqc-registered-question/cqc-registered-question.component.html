<app-error-summary
  *ngIf="submitted && form.invalid"
  [formErrorsMap]="formErrorsMap"
  [form]="form"
  [serverError]="serverError"
>
</app-error-summary>

<div class="govuk-grid-row">
  <div class="govuk-grid-column-full">
    <h1 class="govuk-heading-l">Care Quality Commission regulation</h1>
    <div>submitted = {{ submitted }}</div>
    <div>form.invalid = {{ form.invalid }}</div>
    <div>regulatedByCQC errors = {{ regulatedByCQC.errors | json }}</div>
    <div>regulatedPostcode errors = {{ group.get('regulatedPostcode').errors | json }}</div>
    <div>group errors = {{ group.errors | json }}</div>
    <div>regulatedByCQCControl dirty = {{ regulatedByCQC.dirty }}</div>
    <br />
    <br />

    <form novalidate (ngSubmit)="onSubmit()" [formGroup]="form" id="server-error">
      <div class="govuk-form-group" [class.govuk-form-group--error]="submitted && form.invalid">
        <fieldset class="govuk-fieldset" aria-describedby="regulatedByCQC-error">
          <legend class="govuk-fieldset__legend govuk-fieldset__legend--m">
            <h1 class="govuk-fieldset__heading">
              Are you regulated by the Care Quality Commission (CQC)?
            </h1>
          </legend>
          <span *ngIf="submitted && regulatedByCQC.errors" id="regulatedByCQC-error" class="govuk-error-message">
            <span class="govuk-visually-hidden">Error:</span> Please specify if you are regulated by CQC
          </span>
          <div class="govuk-radios govuk-radios--conditional">
            <!-- regulated -->
            <div class="govuk-radios__item" (click)="setNonRegulatedPostcodelOptional()">
              <input
                data-aria-controls="regulatedByCQC-conditional-1"
                class="govuk-radios__input"
                id="regulatedByCQC-1"
                name="regulatedByCQC"
                type="radio"
                value="yes"
                formControlName="regulatedByCQC"
              />
              <label class="govuk-label govuk-radios__label" for="regulatedByCQC-1">
                Yes
              </label>
            </div>

            <!-- group -->
            <div
              *ngIf="regulatedByCQC.value === 'yes'"
              class="govuk-radios__conditional"
              id="regulatedByCQC-conditional-1"
              formGroupName="group"
            >
              <!-- regulated postcode -->
              <div class="govuk-form-group govuk-!-margin-bottom-2">
                <label class="govuk-label" for="regulatedPostcode">
                  Enter your postcode
                </label>
                <input
                  class="govuk-input govuk-!-width-one-third"
                  id="regulatedPostcode"
                  name="regulatedPostcode"
                  type="text"
                  formControlName="regulatedPostcode"
                  [class.govuk-input--error]="submitted && regulatedPostcode.errors"
                  spellcheck="false"
                />
              </div>

              <!-- divider -->
              <div class="govuk-radios__divider">Or</div>

              <!-- location Id -->
              <div class="govuk-form-group">
                <label class="govuk-label" for="locationId">
                  Enter your location ID number
                </label>
                <input
                  class="govuk-input govuk-!-width-one-third"
                  id="locationId"
                  name="locationId"
                  type="text"
                  formControlName="locationId"
                  [class.govuk-input--error]="submitted && locationId.errors"
                  spellcheck="false"
                />
              </div>
            </div>

            <!-- Not regulated -->
            <div class="govuk-radios__item" (click)="setNonRegulatedPostcodelMandatory()">
              <input
                data-aria-controls="regulatedByCQC-conditional-2"
                class="govuk-radios__input"
                id="regulatedByCQC-2"
                name="regulatedByCQC"
                type="radio"
                value="no"
                formControlName="regulatedByCQC"
              />
              <label class="govuk-label govuk-radios__label" for="regulatedByCQC-2">
                No
              </label>
            </div>

            <div
              *ngIf="regulatedByCQC.value === 'no'"
              class="govuk-radios__conditional"
              id="regulatedByCQC-conditional-2"
            >
              <!-- non regulated postcode -->
              <div class="govuk-form-group govuk-!-margin-bottom-2">
                <label class="govuk-label" for="nonRegulatedPostcode">
                  What is your postcode
                </label>
                <input
                  class="govuk-input govuk-!-width-one-third"
                  id="nonRegulatedPostcode"
                  name="nonRegulatedPostcode"
                  type="text"
                  formControlName="nonRegulatedPostcode"
                  [class.govuk-input--error]="submitted && nonRegulatedPostcode.errors"
                  spellcheck="false"
                />
              </div>
            </div>
          </div>
        </fieldset>
      </div>

      <!--      <div class="form-group mb-5">-->
      <!--        <div class="col-12 p-0">-->
      <!--          <label class="main-body-text-bold mb-3 d-block"-->
      <!--            >Are you regulated by the Care Quality Commission (CQC)?</label-->
      <!--          >-->

      <!--          <div class="row mb-5">-->
      <!--            <div class="col-12">-->
      <!--              <div class="multiple-choice">-->
      <!--                <input type="radio" id="reqQuestionYes" value="true" formControlName="registeredQuestionSelected" />-->
      <!--                <label class="main-body-text p-0" for="reqQuestionYes">Yes</label>-->
      <!--              </div>-->
      <!--            </div>-->

      <!--            <div-->
      <!--              *ngIf="registeredQuestionSelectedValue === 'true'"-->
      <!--              class="panel panel-border-narrow col-10 col-lg-6"-->
      <!--              [ngClass]="{-->
      <!--                'is-invalid':-->
      <!--                  (!submitted &&-->
      <!--                    (regulatedPostcode.errors || locationId.errors || group.errors)) ||-->
      <!--                  (submitted &&-->
      <!--                    (regulatedPostcode.errors || locationId.errors || group.errors)) ||-->
      <!--                  group.hasError('bothHaveContent') ||-->
      <!--                  (cqcPostcodeApiError || cqclocationApiError)-->
      <!--              }"-->
      <!--            >-->
      <!--              <div formGroupName="group">-->
      <!--                <div class="form-group">-->
      <!--                  <label class="form-label" for="postcodeYes">Enter your postcode</label>-->

      <!--                  <span class="invalid-feedback">-->
      <!--                    <span *ngIf="!submittedCqcRegPostcode" class="main-body-text mb-2">{{-->
      <!--                      cqcRegPostcodeMessage-->
      <!--                    }}</span>-->
      <!--                    &lt;!&ndash; <span *ngIf="submitted && !submittedCqcRegPostcode && !submittedCqcRegLocationId" class="main-body-text mb-2">-->
      <!--                        Please enter a postcode or Location ID.-->
      <!--                    </span> &ndash;&gt;-->
      <!--                    <span-->
      <!--                      *ngIf="submittedCqcRegPostcode && regulatedPostcode.hasError('maxlength')"-->
      <!--                      class="main-body-text mb-2"-->
      <!--                    >-->
      <!--                      Your postcode must be no longer than 8 characters.-->
      <!--                    </span>-->
      <!--                    <span-->
      <!--                      *ngIf="submittedCqcRegPostcode && group.hasError('bothHaveContent')"-->
      <!--                      class="main-body-text mb-2"-->
      <!--                    >-->
      <!--                      Both have content-->
      <!--                    </span>-->
      <!--                    <span *ngIf="cqcPostcodeApiError" class="main-body-text mb-2">-->
      <!--                      {{ cqcPostcodeApiError }}-->
      <!--                    </span>-->
      <!--                  </span>-->

      <!--                  <div class="form-control-feedback">-->
      <!--                    <input-->
      <!--                      placeholder="postcode"-->
      <!--                      type="text"-->
      <!--                      id="postcodeYes"-->
      <!--                      class="form-control col-12"-->
      <!--                      formControlName="regulatedPostcode"-->
      <!--                    />-->
      <!--                  </div>-->
      <!--                </div>-->

      <!--                <div class="form-group mt-2">-->
      <!--                  <p class="label mt-4">or</p>-->

      <!--                  <label class="form-label" for="locationId">Enter your location ID number</label>-->

      <!--                  <span class="invalid-feedback">-->
      <!--                    <span *ngIf="!submittedCqcRegLocationId" class="main-body-text mb-2">{{-->
      <!--                      cqcRegLocationIdMessage-->
      <!--                    }}</span>-->
      <!--                    &lt;!&ndash; <span *ngIf="submitted && !submittedCqcRegPostcode && !submittedCqcRegLocationId" class="main-body-text mb-2">-->
      <!--                        Please enter a postcode or Location ID.-->
      <!--                    </span> &ndash;&gt;-->
      <!--                    <span-->
      <!--                      *ngIf="submittedCqcRegLocationId && locationId.hasError('maxlength')"-->
      <!--                      class="main-body-text mb-2"-->
      <!--                    >-->
      <!--                      Your Location ID must be no longer than 50 characters.-->
      <!--                    </span>-->
      <!--                    <span-->
      <!--                      *ngIf="submittedCqcRegPostcode && group.hasError('bothHaveContent')"-->
      <!--                      class="main-body-text mb-2"-->
      <!--                    >-->
      <!--                      Both have content-->
      <!--                    </span>-->
      <!--                    <span *ngIf="cqclocationApiError" class="main-body-text mb-2">-->
      <!--                      {{ cqclocationApiError }}-->
      <!--                    </span>-->
      <!--                  </span>-->

      <!--                  <input-->
      <!--                    placeholder="location"-->
      <!--                    type="text"-->
      <!--                    id="location"-->
      <!--                    class="form-control col-12"-->
      <!--                    formControlName="locationId"-->
      <!--                  />-->
      <!--                </div>-->
      <!--              </div>-->
      <!--            </div>-->
      <!--          </div>-->

      <!--          <div class="row">-->
      <!--            <div class="col-12">-->
      <!--              <div class="multiple-choice">-->
      <!--                <input type="radio" id="regQuestionNo" value="false" formControlName="registeredQuestionSelected" />-->

      <!--                <label class="main-body-text p-0" for="regQuestionNo">No</label>-->
      <!--              </div>-->
      <!--            </div>-->

      <!--            <div-->
      <!--              *ngIf="registeredQuestionSelectedValue === 'false'"-->
      <!--              class="panel panel-border-narrow col-10 col-lg-6"-->
      <!--              [ngClass]="{ 'is-invalid': nonCqcRegPostcodeMessage || nonCqcPostcodeApiError }"-->
      <!--            >-->
      <!--              <div class="field-group">-->
      <!--                <label class="form-label" for="postcodeNo">What is your postcode?</label>-->

      <!--                <span class="invalid-feedback">-->
      <!--                  <span *ngIf="nonCqcRegPostcodeMessage" class="main-body-text mb-2">{{-->
      <!--                    nonCqcRegPostcodeMessage-->
      <!--                  }}</span>-->
      <!--                  <span-->
      <!--                    *ngIf="submittedCqcRegPostcode && nonRegulatedPostcode.hasError('maxlength')"-->
      <!--                    class="main-body-text mb-2"-->
      <!--                  >-->
      <!--                    The Postcode must be no longer than 8 characters.-->
      <!--                  </span>-->
      <!--                  <span *ngIf="nonCqcPostcodeApiError" class="main-body-text mb-2">-->
      <!--                    {{ nonCqcPostcodeApiError }}-->
      <!--                  </span>-->
      <!--                </span>-->

      <!--                <input-->
      <!--                  placeholder="postcode"-->
      <!--                  type="text"-->
      <!--                  id="postcodeNo"-->
      <!--                  class="form-control col-12"-->
      <!--                  formControlName="nonRegulatedPostcode"-->
      <!--                />-->
      <!--              </div>-->
      <!--            </div>-->
      <!--          </div>-->
      <!--        </div>-->
      <!--      </div>-->

      <button class="govuk-button govuk-!-margin-top-2" type="submit">Continue</button>
    </form>
  </div>
</div>
