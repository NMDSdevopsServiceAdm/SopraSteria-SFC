<div>submitted = {{ submitted }}</div>
<div>fileUpload.errors = {{ fileUpload.errors | json }}</div>

<form novalidate (ngSubmit)="onSubmit()" [formGroup]="form">
  <div class="govuk-form-group" [class.govuk-form-group--error]="form.invalid && submitted">
    <label class="govuk-label govuk-visually-hidden" for="fileUpload">
      Choose files
    </label>
    <span *ngIf="form.invalid && submitted" id="fileUpload-error" class="govuk-error-message">
      <span class="govuk-visually-hidden">Error:</span>
      <ng-container *ngIf="fileUpload.hasError('required')">
        {{ getFormErrorMessage('fileUpload', 'required') }}
      </ng-container>
      <ng-container *ngIf="fileUpload.hasError('filecount')">
        {{ getFormErrorMessage('fileUpload', 'filecount') }}
      </ng-container>
      <ng-container *ngIf="fileUpload.hasError('filesize')">
        {{ getFormErrorMessage('fileUpload', 'filesize') }}
      </ng-container>
      <ng-container *ngIf="fileUpload.hasError('filetype')">
        {{ getFormErrorMessage('fileUpload', 'filetype') }}
      </ng-container>
    </span>
    <input
      class="govuk-file-upload"
      [class.govuk-file-upload--error]="form.invalid && submitted"
      id="fileUpload"
      name="fileUpload"
      type="file"
      formControlName="fileUpload"
      (change)="onFilesSelection($event)"
      multiple
    />
  </div>

  <app-selected-files-list></app-selected-files-list>

  <button type="submit" class="govuk-button" *ngIf="!filesUploading">
    Upload files
  </button>

  <button
    *ngIf="selectedFiles?.length && !filesUploading"
    type="button"
    class="govuk-button govuk-button--link govuk-!-margin-left-8"
    (click)="removeFiles()"
  >
    Remove files
  </button>
</form>

<div class="govuk-grid-row" *ngIf="filesUploading">
  <div class="govuk-grid-column-full">
    <div class="govuk-util__normal govuk-!-font-size-19 govuk-util__inline-block">Files uploading</div>
    <progress max="100" class="govuk-!-margin-right-8 govuk-!-margin-left-8"></progress>
    <button type="button" class="govuk-button govuk-button--link" (click)="cancelUpload()">
      Cancel
    </button>
  </div>
</div>
